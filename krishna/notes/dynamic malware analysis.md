1-Network Monitoring Tools Information such as the network connections established by the malware, the addresses it communicates with and how it communicates with those should be reported as a result of the malware analysis 

❖ Wireshark 
❖ Fiddler 
❖ Burp Suite

2-Process Monitoring Tools A new process is created for the program we run for malware analysis. In order to monitor these processes, we should use process monitoring tools. 

❖ Process Hacker 
❖ Process Explorer (SysInternals) 
❖ Procmon (SysInternals)


3-File Activity Monitoring Tools File activities are one of the first activities that should be followed in dynamic analysis. Malware can read files to collect information from the operating system, write other components of the malware to the file system, and move itself to the startup folder to ensure the persistenc 

❖ Sysmon

4-Registry Activities Registries are hierarchical databases that are used for data storage in Windows operating systems. It is used by attackers for purposes such as stealing data and ensuring persistence. Some of these registry keys; 

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce

Steps you should follow after running the malware! 


❖ Process Activities 
❖ Network Activities 
❖ Registry Activities 
❖ File Activities %TEMP% Shell: startup Shell: common startup

Preparing 1. Process Hacker to see the processing activity and the processes belonging to the malware.

![[Pasted image 20240807154212.png]]



2. The malware runs under the explorer process now; we need more details to understand the malware. I will use procmon to understand the tree of the process.


Procmon 
Make sure to press the "Show Process Tree" button in the top menu, procmon will show the process tree it has created for you during the time it has recorded


![[Pasted image 20240807154434.png]]


As we see, the Malware (727ef..) PID=3716 runs the tool called “schtasks.exe” belonging to Windows Task Scheduler (PID 1388) and then runs its own malware (3768 PID) again. Now we need to examine the schtasks.


![[Pasted image 20240807154504.png]]

we see that a scheduled task named "Updates\VbxFiQYCyFDgGL" has been created. However, the information of the scheduled task except for its name is in the XML file located at the following path: “C:\Users\Amanda\AppData\Local\Temp\tmpCCF2.tmp”.


![[Pasted image 20240807154529.png]]


You can see what action will run on the Actions tab. You can see on the above screenshot that the malicious software named “VbxFiQYCyFDgGL.exe” prepared by the attacker will run when this scheduled task runs. We detected malware processes (3716-1388-3768 PIDs)

## Network Activities 

After running the malware, you can see that the process named “722ef401….” on Fiddler communicates with the domain “5gw4d[.]xyz”.


![[Pasted image 20240807154631.png]]

File Activities Now we need to know the file activities and if there is a new drop file. You can enter a filter with Operation=CreateFile to see file creation activities